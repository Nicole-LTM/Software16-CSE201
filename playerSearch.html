<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Sports Stat Searcher</title>
    <style>
        /* Add your CSS styles here */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #search-bar {
            width: 300px;
            padding: 8px;
            font-size: 16px;
        }
        #result {
            margin-top: 20px;
        }
        #main {
          text-align: center;
        }
        #title {
          text-align: center;
          font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
        
        }
        #result div {
          font-weight: bold;
          margin-top: 20px;
        }

        #result pre {
          background-color: #000000;
          border: 1px solid #000000;
          padding: 10px;
        }

        
        


    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="./index.html" style="background-color: #0d6efd;">Home</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
    <div id = "title" class = "row-md justify-content-center">
    <h1>Player Searcher</h1>
    </div>
    <div id="main" class = "container-fluid">
      <div class = "row-md justify-content-center">
      <div class = "col-md">
        <!-- Added File Input for CSV -->
        <input type="file" id="csvFileInput" accept=".csv">
        <label for="search-bar">Search:</label>
        <label for="player1">Player 1:</label>
        <input type="text" id="player1" placeholder="Enter first player name">

        <label for="player2">Player 2:</label>
        <input type="text" id="player2" placeholder="Enter second player name">

        <button type="button" onclick="comparePlayers()" class="btn btn-primary">Compare</button>
        <input type="text" id="search-bar" placeholder="Enter player name here">
        
        <button id="search-button" type="button" onclick="runProgram()" class="btn btn-primary" disabled>Search</button>
        <span id="status"></span>
        <br>
        <!-- Year filter dropdown -->
<label for="yearFilter">Year:</label>
<select id="yearFilter">
    <option value="">All Years</option>
    <option value="TOTAL">TOTAL</option>
    <script>
        const currentYear = new Date().getFullYear();
        for (let year = 2005; year <= currentYear; year++) {
            document.write('<option value="' + year + '">' + year + '</option>');
        }
    </script>
</select>


        <input type ="checkbox" id = "filter2" value= "filter1">
        <label for="filter2"> Filter </label>
        <input type ="checkbox" id = "filter3" value= "filter1">
        <label for="filter3"> Filter </label>
        <input type ="checkbox" id = "filter4" value= "filter1">
        <label for="filter4"> Filter </label>
        <input type ="checkbox" id = "filter5" value= "filter1">
        <label for="filter5"> Filter </label>
      
    </div>
      


      <div id="result" class = "col-md">
        <img src="https://st2.depositphotos.com/3334457/5627/i/450/depositphotos_56276551-stock-photo-american-football-player-in-action.jpg" alt="Football players" class = "img-fluid rounded" width = "1000px" height = "700px">
      </div>
      </div>
    </div>

    <script>
      window.onload = function() {
          loadData();  // Load data as soon as the page is ready
      };
      
      function loadData() {
          var xhr = new XMLHttpRequest();
          xhr.open("GET", "http://10.75.3.181/playerData/QBData.csv", true);
          xhr.onreadystatechange = function () {
              if (xhr.readyState === 4 && xhr.status === 200) {
                  var csvData = xhr.responseText;
                  window.parsedData = parseCSV(csvData);
                  document.getElementById('search-button').disabled = false;  // Enable search button
                  document.getElementById('status').textContent = 'Data loaded. Ready to search!';  // Update status
              } else if (xhr.readyState === 4) {
                  console.error('Failed to fetch data: Status Code: ' + xhr.status);
                  document.getElementById('status').textContent = 'Failed to load data. Check console for errors.';
              }
          };
          xhr.send();
          document.getElementById('status').textContent = 'Loading data...';  // Indicate loading status
      }
      
      function parseCSV(csvData) {
          const lines = csvData.split('\n').map(line => line.trim()).filter(line => line);
          const headers = lines.shift().split(',');
          return lines.map(line => {
              const values = line.split(',');
              return headers.reduce((obj, header, index) => {
                  obj[header] = values[index];
                  return obj;
              }, {});
          });
      }
      
      function runProgram() {
    if (!window.parsedData) {
        alert("Data is not yet loaded, please wait.");
        return;
    }

    const searchTerm = document.getElementById('search-bar').value.toLowerCase();
    const yearFilter = document.getElementById('yearFilter').value;

    const filteredData = window.parsedData.filter(item => {
        const matchesName = item['PLAYER'].toLowerCase().includes(searchTerm);
        let matchesYear = item['YEAR'] === yearFilter; // Directly compare to 'YEAR' field in your data
        return matchesName && (!yearFilter || matchesYear);
    });

    document.getElementById('result').innerHTML = `<pre>${JSON.stringify(filteredData, null, 2)}</pre>`;
}

      
function comparePlayers() {
    if (!window.parsedData) {
        alert("Data is not yet loaded, please wait.");
        return;
    }

    const player1Name = document.getElementById('player1').value.toLowerCase().trim();
    const player2Name = document.getElementById('player2').value.toLowerCase().trim();
    const yearFilter = document.getElementById('yearFilter').value;

    // Filter data for both players based on the name and the selected year or "TOTAL"
    const player1Data = window.parsedData.filter(item => 
        item['PLAYER'].toLowerCase().includes(player1Name) &&
        (item['YEAR'] === yearFilter || yearFilter === "TOTAL" || yearFilter === "")
    );
    const player2Data = window.parsedData.filter(item => 
        item['PLAYER'].toLowerCase().includes(player2Name) &&
        (item['YEAR'] === yearFilter || yearFilter === "TOTAL" || yearFilter === "")
    );

    const resultDiv = document.getElementById('result');
    if (player1Data.length > 0 && player2Data.length > 0) {
        resultDiv.innerHTML = `
            <h3>Comparison Results:</h3>
            <div><strong>${player1Name.toUpperCase()}</strong></div>
            <pre>${JSON.stringify(player1Data, null, 2)}</pre>
            <div><strong>${player2Name.toUpperCase()}</strong></div>
            <pre>${JSON.stringify(player2Data, null, 2)}</pre>
        `;
    } else {
        resultDiv.innerHTML = `<p>No data found for one or both players.</p>`;
    }
}




      
      
      </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
